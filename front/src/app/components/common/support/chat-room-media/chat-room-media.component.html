<aside class="chat-room-media">
  <ul class="chat-room-media__users-list">
    <li class="chat-room-media__user">
      <p class="chat-room-media__username">
        {{ownUsername()}}
      </p>
    </li>
    @for(user of usersList(); let index = $index; track index){
    @if(user !== ownUsername()){
    <li class="chat-room-media__user">
      <p class="chat-room-media__username">
        {{user}}
      </p>
    </li>
    }
    }
  </ul>

  <ul class="chat-room-media__calls-list">
    <h3 class="chat-room-media__local-stream-title">
      Awaiting calls
    </h3>
    @if(!roomsList().length){
    <p>No calls have been made yet</p>
    }

    @for(room of roomsList(); let index = $index; track index){
    <li class="chat-room-media__calls-item">
      Incoming call request from: {{room}}
      <button type="button" class="ycyw__button ycyw__button--2" (click)="connectToRoom(room)"
        [disabled]="room === ownUsername()">Join</button>
    </li>
    }

  </ul>

  <section class="chat-room-media__local-stream">
    <h3 class="chat-room-media__local-stream-title">
      Local stream
    </h3>
    <video autoplay muted playsInline #ownWebCamVideoRef class="chat-room-media__webcam-video"></video>
    <video autoplay playsInline #ownScreenCastVideoRef class="chat-room-media__screen-cast-video"></video>
  </section>

  <section class="chat-room-media__remote-stream">
    <h3 class="chat-room-media__remote-stream-title">
      Remote stream
    </h3>
    <video autoplay playsInline #remoteWebCamVideoRef class="chat-room-media__webcam-video"></video>
    <video autoplay playsInline #remoteScreenCastVideoRef class="chat-room-media__screen-cast-video"></video>
  </section>
  @if(currentRoom()){
  }

  <form class="chat-room-media__controls">
    <label class="chat-room-media__label chat-room-media__control">
      <input type="checkbox" name="local-connection-control" class="chat-room-media__input"
        (change)="toggleWebcam($event)" /> Webcam</label>

    <label class="chat-room-media__label chat-room-media__control">
      <input type="checkbox" name="local-connection-control" class="chat-room-media__input"
        (change)="toggleAudio($event)" /> Audio</label>

    <label class="chat-room-media__label chat-room-media__control">
      <input type="checkbox" name="local-connection-control" class="chat-room-media__input"
        (change)="toggleScreenCast($event)" /> Screen
      cast</label>

  </form>

  @if(!!(currentRoom())){
  @if(isReceiver){
  <button type="button" class="chat-room-media__button ycyw__button ycyw__button--2"
    (click)="disconnectFromRoom()">Disconnect from
    room</button>
  }@else {
  <button type="button" class="chat-room-media__button ycyw__button ycyw__button--2" (click)="deleteRoom()">Delete
    room</button>
  <button type="button" class="chat-room-media__button ycyw__button ycyw__button--1" (click)="initializeConnection()"
    [disabled]="!otherPeerUserName">Start</button>

  }
  <!-- <button type="button" class="chat-room-media__button ycyw__button ycyw__button--1" (click)="sendTestMessage()">Send
    test message</button> -->
  } @else {

  <button type="button" class="chat-room-media__button ycyw__button ycyw__button--1" (click)="createRoom()"
    [disabled]="!!(currentRoom())">Create new
    room</button>
  }
</aside>